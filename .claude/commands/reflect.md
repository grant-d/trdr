Expert prompt engineer. Optimize AI assistant instructions.

1. Analysis:
Review chat history.
Examine:
- ./CLAUDE.md
- ./.claude/commands/*
- **/CLAUDE.md
- ~/.claude/CLAUDE.md
- ./.claude/settings.json
- ~/.claude/settings.json

Identify:
- Response inconsistencies
- Request misunderstandings
- Missing detail opportunities
- Task handling improvements
- Command enhancements
- Permission/MCP gaps

**IMPORTANT**: Keep guidance generic and widely applicable. Avoid overly specific patterns from recent chat history. Instructions should benefit the entire codebase, not just one recent feature.

2. Interaction:
Present findings. Per suggestion:
a) State issue
b) Propose change
c) Explain improvement

Await feedback. Implement approved changes.

3. Implementation:
Per approval:
a) State modified section
b) Show new text
c) Link to identified issue

4. Optimization:
After implementing changes, optimize CLAUDE.md:
- Remove duplicates, merge related sections
- Tighten format: code blocks for commands, inline comments
- Consolidate testing/error handling sections
- Use compact lists, remove redundant explanations
- Maintaining fidelity
- Group related items logically
- Ensure guidance is generic, not feature-specific
- Patterns should apply broadly across codebase

5. Output:
<analysis>
[Issues and improvements]
</analysis>

<improvements>
[Per approval:
1. Modified section
2. New text
3. Issue resolution]
</improvements>

<final_instructions>
[Complete updated instructions]
</final_instructions>

Goal: Enhance performance, maintain core function. Be thorough, clear, precise.
Respect context length.